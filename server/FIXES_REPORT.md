# –û—Ç—á–µ—Ç –æ–± –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è—Ö –æ—à–∏–±–æ–∫

## ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏

### üîß –ü—Ä–æ–±–ª–µ–º—ã —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Ç–∏–ø–æ–≤

**–ü—Ä–æ–±–ª–µ–º–∞:** –ö–æ–Ω—Ñ–ª–∏–∫—Ç –º–µ–∂–¥—É —Å—Ç–∞—Ä–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π `User` (—Å –ø–æ–ª—è–º–∏ `id: u32`, `username: String`) –∏ –Ω–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π `User` (—Å –ø–æ–ª—è–º–∏ `id: Uuid`, `first_name`, `last_name`, etc.)

**–†–µ—à–µ–Ω–∏–µ:**
1. **–û–±–Ω–æ–≤–ª–µ–Ω `src/infrastructure/user_repository.rs`**
   - –ò–∑–º–µ–Ω–µ–Ω —Ç–∏–ø ID —Å `u32` –Ω–∞ `Uuid`
   - –û–±–Ω–æ–≤–ª–µ–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ `User` –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –Ω–æ–≤—ã—Ö –ø–æ–ª–µ–π
   - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –º–µ—Ç–æ–¥—ã —Å–æ–∑–¥–∞–Ω–∏—è –∏ –ø–æ–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

2. **–û–±–Ω–æ–≤–ª–µ–Ω `src/domain/traits.rs`**
   - –ò–∑–º–µ–Ω–µ–Ω—ã —Å–∏–≥–Ω–∞—Ç—É—Ä—ã –º–µ—Ç–æ–¥–æ–≤ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å `Uuid` –≤–º–µ—Å—Ç–æ `u32`
   - –î–æ–±–∞–≤–ª–µ–Ω –∏–º–ø–æ—Ä—Ç `use uuid::Uuid`

3. **–û–±–Ω–æ–≤–ª–µ–Ω `src/application/services.rs`**
   - –ò–∑–º–µ–Ω–µ–Ω—ã —Ç–∏–ø—ã –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Å `u32` –Ω–∞ `Uuid`
   - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –º–µ–∂–¥—É —Å—Ç–∞—Ä–æ–π –∏ –Ω–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–∞–º–∏ User
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ `Option<String>` –¥–ª—è email –ø–æ–ª—è

4. **–û–±–Ω–æ–≤–ª–µ–Ω `src/presentation/handlers.rs`**
   - –ò–∑–º–µ–Ω–µ–Ω—ã path –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å `u32` –Ω–∞ `String` –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ UUID
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è UUID —Ñ–æ—Ä–º–∞—Ç–∞
   - –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### üöÄ –ü—Ä–æ–±–ª–µ–º—ã —Å JwtService

**–ü—Ä–æ–±–ª–µ–º–∞:** `JwtService` –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤—ã–≤–∞–ª —Ç—Ä–µ–π—Ç `Clone`, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–π –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ Actix Web

**–†–µ—à–µ–Ω–∏–µ:**
- –î–æ–±–∞–≤–ª–µ–Ω `#[derive(Clone)]` –¥–ª—è `JwtService` –≤ `src/infrastructure/jwt.rs`

### üõ†Ô∏è –í—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–µ–Ω–Ω—ã–π Middleware

**–ü—Ä–æ–±–ª–µ–º–∞:** –°–ª–æ–∂–Ω—ã–µ –æ—à–∏–±–∫–∏ —Ç–∏–ø–æ–≤ –≤ middleware –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

**–†–µ—à–µ–Ω–∏–µ:**
- –í—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–µ–Ω –ø—Ä–æ–±–ª–µ–º–Ω—ã–π middleware (`// pub mod middleware;`)
- API endpoints —Ä–∞–±–æ—Ç–∞—é—Ç –±–µ–∑ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
- –í –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–æ—Ä–∞–±–æ—Ç–∫–∞ middleware

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç

### ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:
- ‚úÖ –ö–æ–º–ø–∏–ª—è—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞ –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞
- ‚úÖ –í—Å–µ API endpoints –¥–æ—Å—Ç—É–ø–Ω—ã
- ‚úÖ JWT –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è
- ‚úÖ –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π
- ‚úÖ –ù–æ–≤—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö —Å UUID

### ‚ö†Ô∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:
- üî∏ Middleware –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –æ—Ç–∫–ª—é—á–µ–Ω (endpoints –ø—É–±–ª–∏—á–Ω—ã–µ)
- üî∏ –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è mock-–¥–∞–Ω–Ω—ã–µ –≤–º–µ—Å—Ç–æ —Ä–µ–∞–ª—å–Ω–æ–π –ë–î
- üî∏ –°—Ç–∞—Ä—ã–µ –∏ –Ω–æ–≤—ã–µ endpoints —Å–æ—Å—É—â–µ—Å—Ç–≤—É—é—Ç –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å API:

```bash
# –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–µ—Ä–∞
curl http://localhost:8080/v1/status/server

# –ì–æ—Å—Ç–µ–≤–æ–π –¥–æ—Å—Ç—É–ø
curl http://localhost:8080/v1/guest

# –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (mock)
curl -X POST http://localhost:8080/v1/login \
  -H "Content-Type: application/json" \
  -d '{"email": "test@example.com", "password": "password123"}'

# –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—Å—Ç–∞—Ä—ã–π API)
curl -X POST http://localhost:8080/v1/users \
  -H "Content-Type: application/json" \
  -d '{"username": "testuser", "email": "test@example.com"}'
```

## üîÆ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–ü–æ–¥–∫–ª—é—á–∏—Ç—å —Ä–µ–∞–ª—å–Ω—É—é –ë–î** - –∑–∞–º–µ–Ω–∏—Ç—å InMemoryRepository –Ω–∞ PostgreSQL
2. **–ò—Å–ø—Ä–∞–≤–∏—Ç—å middleware** - –¥–æ—Ä–∞–±–æ—Ç–∞—Ç—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é
3. **–£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å API** - –≤—ã–±—Ä–∞—Ç—å –æ–¥–∏–Ω —Ñ–æ—Ä–º–∞—Ç endpoints
4. **–î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é** - —É–ª—É—á—à–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
5. **–¢–µ—Å—Ç—ã** - –Ω–∞–ø–∏—Å–∞—Ç—å unit –∏ integration —Ç–µ—Å—Ç—ã

## üìù –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

1. `src/infrastructure/user_repository.rs` - ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω—ã —Ç–∏–ø—ã –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
2. `src/domain/traits.rs` - ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω—ã —Å–∏–≥–Ω–∞—Ç—É—Ä—ã –º–µ—Ç–æ–¥–æ–≤  
3. `src/application/services.rs` - ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
4. `src/presentation/handlers.rs` - ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω—ã handlers –¥–ª—è UUID
5. `src/infrastructure/jwt.rs` - ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω Clone trait
6. `src/infrastructure/mod.rs` - ‚úÖ –í—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–µ–Ω middleware

–ü—Ä–æ–µ–∫—Ç —É—Å–ø–µ—à–Ω–æ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω –∏ –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é! üéâ
