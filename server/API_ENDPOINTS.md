# API Endpoints –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## üöÄ –ù–∞—Å—Ç—Ä–æ–π–∫–∞

–î–æ–±–∞–≤—å—Ç–µ –≤ –≤–∞—à `.env` —Ñ–∞–π–ª:

```env
JWT_SECRET=your_super_secret_key_here
```

## üìã –°–ø–∏—Å–æ–∫ —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤

### üîì –ü—É–±–ª–∏—á–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã (–Ω–µ —Ç—Ä–µ–±—É—é—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏)

#### PUT /v1/register - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
–°–æ–∑–¥–∞–µ—Ç –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Å–∏—Å—Ç–µ–º–µ.

**–ó–∞–ø—Ä–æ—Å:**
```json
{
  "username": "ivan_petrov",
  "first_name": "–ò–≤–∞–Ω",
  "last_name": "–ü–µ—Ç—Ä–æ–≤", 
  "email": "ivan@example.com",
  "password": "password123"
}
```

**–û—Ç–≤–µ—Ç (201):**
```json
{
  "id": "123e4567-e89b-12d3-a456-426614174000",
  "email": "ivan@example.com",
  "message": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É—Å–ø–µ—à–Ω–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω"
}
```

#### POST /v1/login - –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è  
–ê–≤—Ç–æ—Ä–∏–∑—É–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ username –∏ –ø–∞—Ä–æ–ª—é –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç JWT —Ç–æ–∫–µ–Ω—ã.

**–ó–∞–ø—Ä–æ—Å:**
```json
{
  "username": "maxnemoy",
  "password": "qwerty"
}
```

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "refresh_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "user": {
    "id": "123e4567-e89b-12d3-a456-426614174000",
    "username": "maxnemoy",
    "first_name": "Max",
    "last_name": "Nemoy", 
    "email": "maxnemoy@gmail.com",
    "user_type_id": 5
  }
}
```

#### POST /v1/token - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞
–û–±–Ω–æ–≤–ª—è–µ—Ç access —Ç–æ–∫–µ–Ω –∏—Å–ø–æ–ª—å–∑—É—è refresh —Ç–æ–∫–µ–Ω.

**–ó–∞–ø—Ä–æ—Å:**
```json
{
  "refresh_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
}
```

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
}
```

#### GET /v1/guest - –ì–æ—Å—Ç–µ–≤–æ–π –¥–æ—Å—Ç—É–ø
–û—Ç–∫—Ä—ã—Ç—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç –¥–ª—è –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "message": "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å! –≠—Ç–æ –æ—Ç–∫—Ä—ã—Ç—ã–π endpoint",
  "timestamp": "2024-01-01T12:00:00Z"
}
```

### üîí –ó–∞—â–∏—â–µ–Ω–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã (—Ç—Ä–µ–±—É—é—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏)

**–ó–∞–≥–æ–ª–æ–≤–æ–∫ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:**
```
Authorization: Bearer <access_token>
```

#### GET /v1/user - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–µ–∫—É—â–µ–º –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ **–∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö** –Ω–∞ –æ—Å–Ω–æ–≤–µ JWT —Ç–æ–∫–µ–Ω–∞.

**–ó–∞–≥–æ–ª–æ–≤–∫–∏:**
```
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "id": "123e4567-e89b-12d3-a456-426614174000",
  "username": "maxnemoy",
  "first_name": "Max",
  "last_name": "Nemoy", 
  "email": "maxnemoy@gmail.com",
  "user_type_id": 5
}
```

**–û—à–∏–±–∫–∏:**
- `401 Unauthorized` - –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∏–ª–∏ –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω
- `404 Not Found` - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –ë–î

#### PATCH /v1/user - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
–û–±–Ω–æ–≤–ª—è–µ—Ç –ø–æ–ª—è —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è **–≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö** –Ω–∞ –æ—Å–Ω–æ–≤–µ JWT —Ç–æ–∫–µ–Ω–∞.

**–ó–∞–≥–æ–ª–æ–≤–∫–∏:**
```
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```

**–ó–∞–ø—Ä–æ—Å:**
```json
{
  "first_name": "–ù–æ–≤–æ–µ –ò–º—è",
  "last_name": "–ù–æ–≤–∞—è –§–∞–º–∏–ª–∏—è",
  "email": "newemail@example.com"
}
```

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "user": {
    "id": "123e4567-e89b-12d3-a456-426614174000",
    "username": "maxnemoy",
    "first_name": "–ù–æ–≤–æ–µ –ò–º—è",
    "last_name": "–ù–æ–≤–∞—è –§–∞–º–∏–ª–∏—è", 
    "email": "newemail@example.com",
    "user_type_id": 5
  },
  "message": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω"
}
```

**–û—à–∏–±–∫–∏:**
- `401 Unauthorized` - –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∏–ª–∏ –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω
- `404 Not Found` - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –ë–î

### ü©∫ –°–ª—É–∂–µ–±–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

#### GET /v1/status/server - –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–µ—Ä–∞
```json
{
  "status": "ok",
  "message": "pong"
}
```

#### GET /v1/status/db - –°—Ç–∞—Ç—É—Å –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
```json
{
  "status": "ok", 
  "message": "–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–æ—Å—Ç—É–ø–Ω–∞",
  "connected": true
}
```

## üîê JWT –¢–æ–∫–µ–Ω—ã

- **Access Token:** –î–µ–π—Å—Ç–≤—É–µ—Ç 15 –º–∏–Ω—É—Ç
- **Refresh Token:** –î–µ–π—Å—Ç–≤—É–µ—Ç 30 –¥–Ω–µ–π

## ‚ùå –û—à–∏–±–∫–∏

### 400 Bad Request
```json
{
  "error": "Email –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω"
}
```

### 401 Unauthorized
```json
{
  "error": "–¢—Ä–µ–±—É–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è"
}
```

### 500 Internal Server Error
```json
{
  "error": "–û—à–∏–±–∫–∞ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –ø–∞—Ä–æ–ª—è"
}
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API

### –ü—Ä–∏–º–µ—Ä —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å curl:

1. **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è:**
```bash
curl -X POST http://localhost:8080/v1/login \
  -H "Content-Type: application/json" \
  -d '{"username": "maxnemoy", "password": "qwerty"}'
```

2. **–ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ:**
```bash
# –°–Ω–∞—á–∞–ª–∞ –ø–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω —á–µ—Ä–µ–∑ /v1/login, –∑–∞—Ç–µ–º –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –µ–≥–æ:
curl -X GET http://localhost:8080/v1/user \
  -H "Authorization: Bearer YOUR_ACCESS_TOKEN"
```

3. **–ì–æ—Å—Ç–µ–≤–æ–π –¥–æ—Å—Ç—É–ø:**
```bash
curl -X GET http://localhost:8080/v1/guest
```

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –í—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç JSON
- –ü–∞—Ä–æ–ª–∏ —Ö–µ—à–∏—Ä—É—é—Ç—Å—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º bcrypt
- UUID v4 –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ç–∏–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (default, admin, moderator)
- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ soft delete (–ø–æ–ª–µ deleted_at)
